#A script to generate hemisphere-specific surrogate maps that preserve the spatial autocorrelation present in the BigBrain cytoarchitectural variation gradient. These surrogates will be reflected across hemispheres and used as null maps for determining the significance of relationships between developmental maps and cytoarchitecture 

from brainsmash.mapgen.base import Base
import numpy as np
import pandas as pd

#Load hemisphere-specific HCP-MMP distance matrices for the frontal lobe, generated by compute_parcellated_geodesicdistmat.py and mask_parcellated_distmat_frontallobe.R
rh_distmat_glasser = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/RightParcellatedGeodesicDistmat_fslr32k_glasser_frontallobe.txt")
lh_distmat_glasser = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/LeftParcellatedGeodesicDistmat_fslr32k_glasser_frontallobe.txt")

#Load hemisphere specific bigbrain data for generating surrogates 
BB_rh = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/Bigbrain.rh.frontallobe.glasser.txt")
BB_lh = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/Bigbrain.lh.frontallobe.glasser.txt")

#Generate surrogate maps with spatial autocorrelation (params validated with variogram visualization)
gen_rh = Base(BB_rh, rh_distmat_glasser, pv = 70, seed = 611) #seed = my birthday! 
surrogate_maps_rh = gen_rh(n=500)

gen_lh = Base(BB_lh, lh_distmat_glasser, pv = 70, seed = 611)
surrogate_maps_lh = gen_lh(n=500)

#Save out surrogates for computing brainmash-based p-values 
surrogate_maps_rh_df = pd.DataFrame(surrogate_maps_rh)
surrogate_maps_rh_df.to_csv("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/Bigbrain.rh.frontallobe.surrogates.txt", index=False)

surrogate_maps_lh_df = pd.DataFrame(surrogate_maps_lh)
surrogate_maps_lh_df.to_csv("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/Bigbrain.lh.frontallobe.surrogates.txt", index=False)


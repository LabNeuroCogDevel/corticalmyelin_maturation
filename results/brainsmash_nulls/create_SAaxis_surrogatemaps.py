#A script to generate hemisphere-specific surrogate maps that preserve the spatial autocorrelation present in the S-A axis. These surrogates will be reflected across hemispheres and used as null maps for determining the significance of relationships between developmental maps and the S-A axis 

from brainsmash.mapgen.base import Base
import numpy as np
import pandas as pd

#Load hemisphere-specific HCP-MMP distance matrices, generated by compute_parcellated_geodesicdistmat.py
rh_distmat_glasser = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/RightParcellatedGeodesicDistmat_fslr32k_glasser.txt")
lh_distmat_glasser = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/LeftParcellatedGeodesicDistmat_fslr32k_glasser.txt")

#Load hemisphere specific S-A axis data for generating surrogates 
SA_rh = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/SA.rh.glasser.txt")
SA_lh = np.loadtxt("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/SA.lh.glasser.txt")

#Generate surrogate maps with spatial autocorrelation (params validated with variogram visualization)
gen_rh = Base(SA_rh, rh_distmat_glasser, pv = 70, seed = 731) #seed = Harry Potter's birthday
surrogate_maps_rh = gen_rh(n=500)

gen_lh = Base(SA_lh, lh_distmat_glasser, pv = 70, seed = 731)
surrogate_maps_lh = gen_lh(n=500)

#Save out surrogates for computing brainmash-based p-values 
surrogate_maps_rh_df = pd.DataFrame(surrogate_maps_rh)
surrogate_maps_rh_df.to_csv("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/SAaxis.rh.surrogates.txt", index=False)

surrogate_maps_lh_df = pd.DataFrame(surrogate_maps_lh)
surrogate_maps_lh_df.to_csv("/Volumes/Hera/Projects/corticalmyelin_development/Maps/Brainsmash/smash_data/SAaxis.lh.surrogates.txt", index=False)

